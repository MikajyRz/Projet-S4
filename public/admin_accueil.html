<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Administration - Ajout de Fonds</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
    <div class="w-full max-w-md">
        <h1 class="text-2xl font-bold mb-6 text-center">Ajouter des Fonds</h1>
        <div class="bg-white p-6 rounded-lg shadow-md">
            <form id="addFondsForm" class="space-y-4">
                <div>
                    <label for="montant" class="block text-sm font-medium text-gray-700">Montant (€)</label>
                    <input type="number" step="0.01" min="0.01" id="montant" name="montant" 
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"
                           required>
                </div>
                <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Ajouter
                </button>
            </form>
            <div id="message" class="mt-4 text-sm hidden"></div>
        </div>
    </div>

    <script>
        const apiBase = "http://localhost/Projet-S4/ws";
        document.getElementById('addFondsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const montant = document.getElementById('montant').value;
            const messageDiv = document.getElementById('message');

            // Validation côté client
            if (!montant || parseFloat(montant) <= 0) {
                messageDiv.classList.remove('hidden', 'text-green-500');
                messageDiv.classList.add('text-red-500');
                messageDiv.textContent = 'Veuillez entrer un montant positif.';
                return;
            }

            try {
                const response = await fetch(`${apiBase}/fonds`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ montant: parseFloat(montant) })
                });

                const result = await response.json();
                
                messageDiv.classList.remove('hidden');
                if (response.ok) {
                    messageDiv.classList.remove('text-red-500');
                    messageDiv.classList.add('text-green-500');
                    messageDiv.textContent = result.message;
                    document.getElementById('addFondsForm').reset(); // Réinitialiser le formulaire
                } else {
                    messageDiv.classList.remove('text-green-500');
                    messageDiv.classList.add('text-red-500');
                    messageDiv.textContent = result.error || 'Erreur lors de l\'ajout des fonds.';
                }
            } catch (error) {
                messageDiv.classList.remove('hidden', 'text-green-500');
                messageDiv.classList.add('text-red-500');
                messageDiv.textContent = 'Erreur de connexion au serveur.';
            }
        });
    </script>
</body>
</html>